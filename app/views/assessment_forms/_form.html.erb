<blockquote>
  <h2>基本資料</h2>

  <%= f.collection_select :residentID, Resident.all, :id, :bedNumber_with_resident, label: "住民" %>
  <%= f.select :afLiverFunction, [["正常", "正常"], ["異常", "異常"]], label: "肝功能" %>
  <%= f.select :afKidneyFunction, [["正常", "正常"], ["異常", "異常"]], label: "腎功能" %>
  <%= f.select :afDruguse, [["需管灌", "需管灌"], ["需磨碎", "需磨碎"], ["可直接吞服固體", "可直接吞服固體"]], label: "用藥狀況" %>
  <%= f.text_field :allergyFood, label: "過敏食物種類", placeholder: "無過敏食物請留空" %>
  <%= f.text_field :allergyDrug, label: "過敏藥物種類", placeholder: "無過敏藥物請留空" %>
  <%= f.select :referenceAccessories, [["生命徵象紀錄表", "生命徵象紀錄表"], ["檢驗數據", "檢驗數據"], ["護理紀錄", "護理紀錄"], ["醫囑", "醫囑"], ["其他", "其他"]], label: "交付藥物治療評估參考附件" %>
</blockquote>


<blockquote>
  <%= f.fields_for :af_prescription_content do |content_form| %>
  <h2>處方內容或保健食品</h2>
  <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingOne">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          處方內容一
        </a>
      </h4>
    </div>
    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
      <div class="panel-body">
        <%= content_form.text_field :hospitalName1, label: "醫院名稱" %>
        <%= content_form.text_field :division1, label: "科別" %>
        <%= content_form.date_select :doctorDate1, label: "看診日", :include_blank => true, :default => nil %>
        <%= content_form.number_field :days1, :min => 0, label: "天數" %>
        <%= content_form.text_area :remark1, :size => "20x5", label: "備註" %>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingTwo">
      <h4 class="panel-title">
        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-controls="collapseTwo">
          處方內容二
        </a>
      </h4>
    </div>
    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
      <div class="panel-body">
        <%= content_form.text_field :hospitalName2, label: "醫院名稱" %>
        <%= content_form.text_field :division2, label: "科別" %>
        <%= content_form.date_select :doctorDate2, label: "看診日", :include_blank => true, :default => nil %>
        <%= content_form.number_field :days2, :min => 0, label: "天數"%>
        <%= content_form.text_area :remark2, :size => "20x5", label: "備註" %>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingThree">
      <h4 class="panel-title">
        <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-controls="collapseThree">
          處方內容三
        </a>
      </h4>
    </div>
    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
      <div class="panel-body">
        <%= content_form.text_field :hospitalName3, label: "醫院名稱" %>
        <%= content_form.text_field :division3, label: "科別" %>
        <%= content_form.date_select :doctorDate3, label: "看診日", :include_blank => true, :default => nil %>
        <%= content_form.number_field :days3, :min => 0, label: "天數" %>
        <%= content_form.text_area :remark3, :size => "20x5", label: "備註" %>
      </div>
    </div>
  </div>
</div>
<% end %>
</blockquote>


<blockquote>
  <%= f.fields_for :af_pharmacist_assess do |assess_form| %>
    <h2>藥師評估結果</h2>
    <% br_flag = 1 %>


    <% @result_array.each do |result| %>
      <%= render :partial => 'result_checkbox', :locals => { :result => result } %>
      <% br_flag += 1 %>

      <% if br_flag % 4 == 1 %>
        <br ><br >
      <% end %>
    <% end %>

    <%= assess_form.text_area :suggestion, :size => "20x5", label: "藥師建議內容" %>
    <%= assess_form.select :referenceData, [["仿單", "仿單"], ["藥物治療手冊", "藥物治療手冊"]], label: "參考資料" %>
    <%= assess_form.select :referenceBooks, [["Micromedex", "Micromedex"], ["PubMed", "PubMed"], ["UpToDate", "UpToDate"], ["其他", "其他"]], label: "參考書籍" %>
  <% end %>
</blockquote>

<blockquote>
  <%= f.fields_for :af_nurse_handling do |handling_form| %>
    <h2>護理人員處置方式</h2>
    <%= handling_form.select :mode, [["持續觀察住民臨床症狀", "持續觀察住民臨床症狀"], ["持續觀察住民是否有藥物引發之副作用", "持續觀察住民是否有藥物引發之副作用"], ["照會醫師", "照會醫師"], ["其他", "其他"]], label: "處置方式" %>
    <%= handling_form.select :doctorDo, [["醫師接受藥師建議", "醫師接受藥師建議"], ["醫師未接受建議", "醫師未接受建議"]], label: "醫師處置方式", :disabled => true %>

    <%= handling_form.text_field :residentFollow, label: "住民療效追蹤" %>

  <% end %>
</blockquote>

<script type="text/javascript">
  $('#assessment_form_af_nurse_handling_attributes_doctorDo').attr('disabled', true);
  doctorDo_able();

  $('#assessment_form_af_nurse_handling_attributes_mode').change(function() {
    doctorDo_able();
  });

  function doctorDo_able() {
    if ($('#assessment_form_af_nurse_handling_attributes_mode').val() != "照會醫師")  {
      $('#assessment_form_af_nurse_handling_attributes_doctorDo').attr('disabled', true);
    } else {
      $('#assessment_form_af_nurse_handling_attributes_doctorDo').attr('disabled', false);
    }
  }
</script>

<br /><br />
